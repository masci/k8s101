<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Secrets - k8s101</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">k8s101</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Course units <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../010-first-contact/" class="dropdown-item">First contact</a>
</li>
                                    
<li>
    <a href="../020-pods/" class="dropdown-item">Pods</a>
</li>
                                    
<li>
    <a href="../030-declarative/" class="dropdown-item">Going declarative</a>
</li>
                                    
<li>
    <a href="../040-labels/" class="dropdown-item">Labels</a>
</li>
                                    
<li>
    <a href="../050-annotations/" class="dropdown-item">Annotations</a>
</li>
                                    
<li>
    <a href="../060-deployments/" class="dropdown-item">Deployments</a>
</li>
                                    
<li>
    <a href="../070-services/" class="dropdown-item">Services</a>
</li>
                                    
<li>
    <a href="../080-ingress/" class="dropdown-item">Ingress</a>
</li>
                                    
<li>
    <a href="../090-configmaps/" class="dropdown-item">Config Maps</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Secrets</a>
</li>
                                    
<li>
    <a href="../110-helm/" class="dropdown-item">Helm</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../090-configmaps/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../110-helm/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://github.com/masci/k8s101/tree/master/src/100-secrets.md" class="nav-link"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#secrets" class="nav-link">Secrets</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#exercise-n1-create-a-secret-with-kubectl" class="nav-link">Exercise n.1: create a secret with kubectl</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#exercise-n2-create-a-secret-manually" class="nav-link">Exercise n.2: create a secret manually</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="secrets">Secrets</h1>
<p><strong>Secret</strong> resources are very similar to <strong>ConfigMap</strong> but they were introduced
later, with the goal to store sensitive informations and you should consider this
feature still a work in progress, at least in vanilla instance of Kubernetes.
In fact at this time Kubernetes secrets are stored in plain-text, base64 encoded
format.</p>
<p>It's important to stress the fact that <strong>Encoding is not Encryption</strong>: despite the
name and the original design, Kubernetes' secrets can't be trusted to store
sensitive informations without providing some kind of encryption on top of them.
Some cloud providers encrypt Kubernetes secrets at the application layer, see
for example <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/encrypting-secrets">GKE</a>.</p>
<h2 id="exercise-n1-create-a-secret-with-kubectl">Exercise n.1: create a secret with kubectl</h2>
<p>Same as config maps, there are several options to create a secret, for brevity
we'll pass our secret strings to <code>kubectl</code>:</p>
<pre><code class="sh">$ kubectl create secret generic my-secret --from-literal=username=superuser --from-literal=password=topsecret
secret/my-secret created
</code></pre>

<p>You can see what's in your secret by running:</p>
<pre><code class="sh">$ kubectl describe secret my-secret
Name:         my-secret
&lt;snuip&gt;
Data
====
username:  9 bytes
password:  9 bytes
</code></pre>

<p>As you can see, differently from a config map we can't see the plain text version of our data
because <code>kubectl</code> encoded the literals in base64 on the fly.</p>
<h2 id="exercise-n2-create-a-secret-manually">Exercise n.2: create a secret manually</h2>
<p>If we want to manually create a secret, we have to handle encoding ourselves:</p>
<pre><code class="sh">$ echo -n 'admin' | base64
YWRtaW4=
</code></pre>

<p>Then we can use the encoded value (e.g.) in a yaml definition like this:</p>
<pre><code>apiVersion: v1
kind: Secret
metadata:
  name: mysecret
type: Opaque
data:
  username: YWRtaW4=
</code></pre>

<p>And create the object:</p>
<pre><code class="sh">$ cat &lt;&lt;EOF | kubectl apply -f -
apiVersion: v1
kind: Secret
metadata:
  name: mysecret
type: Opaque
data:
  username: YWRtaW4=
EOF
secret/mysecret created
</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
